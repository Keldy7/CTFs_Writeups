# DÃ©couvre le C&C

> Level: xxx || 70 points


## 1. Data

> Instruction

![Instruction Challenge Decouvre_C&C](challenge_Decouvre-C&C.jpeg)

> Resource

A zipped file : `Powershell_command.zip` (See Resource folder)


## 2. Solution

To begin with, we decompress the archive using the password *OrangeCTF*. We obtain a `Powershell_command.txt` file. We analyze the contents with the `strings` command to see if there is any sensitive information.

At first glance, we notice an obfuscated PowerShell script running in the background (hidden). One detail in particular catches our eye: the use of the `-encodedCommand` option. This is often used to hide malicious commands. This alerts us to the possibility that this script may be dangerous.

![Decompressed file](https://github.com/user-attachments/assets/ee135366-008c-4b36-87fa-2d7feeb8bb62)


To find out more about the nature of the file, we analyze it on [VirusTotal](https://www.virustotal.com/) , a fabulous online tool which allows us to detect whether a file is malicious thanks to numerous antivirus engines, and also to visualize the network relationships it may have with remote servers. We found that the file was indeed considered malicious, as it was detected by 30 out of 63 antivirus engines.

![Malware](https://github.com/user-attachments/assets/d9464adf-7141-4d23-96a8-bef418af4fc4)


We took our analysis a step further by consulting VirusTotal's *RELATIONS* tab. We discover that the script establishes a connection with a unique IP address located in the United States (US).

![IP address found](https://github.com/user-attachments/assets/0cf7eca1-72b9-4d35-85dc-5135c04fd193)

<br>
ðŸš¨**Make sure you open the file on a Linux virtual machine, as Windows will automatically delete it if you try to view its contents.** ðŸš¨

## 3. Flag

```text
OCI_{54.174.203.61}
```
